!function(e){function t(t){for(var o,i,l=t[0],a=t[1],c=t[2],u=0,f=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);for(d&&d(t);f.length;)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,l=1;l<n.length;l++){var a=n[l];0!==r[a]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={0:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/js/";var l=window.webpackJsonp=window.webpackJsonp||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=a;s.push([47,1]),n()}({47:function(e,t,n){n(48),n(49),n(79),e.exports=n(90)},48:function(e,n){var o,r,s,i,l,a,c;OCA.Books||(OCA.Books={}),OCA.Books.Core=(o={},r=[],s={},i=void 0,l=void 0,a=void 0,c=function(e,t){t=t.substring(0,t.lastIndexOf("/")+1),e.forEach((function(e){e.href=t+e.href,c(e.subitems,t)}))},{init:function(){window.addEventListener("bookstylechange",(function(){i&&i.themes.default(OCA.Books.UI.Style.get())})),OCA.Books.Backend.getConfig((function(e){document.querySelector("#path-settings").value=e.library,o=e})),OCA.Books.Backend.getBooks((function(e){e.success&&(r=e.data,OCA.Books.UI.init(),OCA.Books.UI.buildShelf(r),OCA.Books.UI.buildNavigation(r))}))},open:function(e,t){this.close(),OCA.Books.UI.openReader(),OCA.Books.UI.showLoadingScreen();let n=o.remote+this.getBook(e).filename,d=ePub(n,{replacements:"blobUrl",openAs:"epub"});d.loaded.navigation.then((function(e){let t=d.packaging.navPath||d.packaging.ncxPath;t?c(e.toc,t):e=d.spine.items.map(e=>({label:e.idref,href:e.href,subitems:[]})),OCA.Books.UI.buildTOC(e)})),d.ready.then((function(){d.locations.generate(1e3).then((function(){OCA.Books.UI.hideLoadingScreen();let n=[];d.spine.each((function(e){let t=e.cfiFromElement(e.document);n.push(d.locations.percentageFromCfi(t))})),OCA.Books.UI.buildMarkers(n),(i=d.renderTo(t,{width:"100%",height:"100%"})).id=e,i.themes.default(OCA.Books.UI.Style.get()),i.display(function(e){let t=r.find(t=>t.id==e);if(t&&t.progress)return t.progress}(e)),i.on("relocated",(function(){clearTimeout(l),l=setTimeout((function(){let e=i.location.start.cfi,t=i.book.locations.percentageFromCfi(e),n=[];i.book.navigation.toc.map(e=>[e].concat(e.subitems)).flat().filter(e=>e.href.startsWith(s.href)).forEach(e=>{let t=e.href.split("#")[1],o=t?s.document.getElementById(t):s.document.body,r=i.book.locations.percentageFromCfi(s.cfiFromElement(o));n.push({href:e.href,percent:r})});let o=n.filter(e=>e.percent<=t).pop()||n[0]||{href:s.href};OCA.Books.UI.refreshProgress(t,o.href)}),250),clearTimeout(a),a=setTimeout((function(){let e=i.location.start.cfi;if(i.book.locations.percentageFromCfi(e)>0){let t=r.find(e=>e.id==i.id);OCA.Books.Backend.saveProgress(i.id,e,(function(n){if(n.success){let n=t.status;t.progress=e,t.status=t.status||1,OCA.Books.UI.refreshStatus(i.id,t.status,n)}}))}}),1e3)})),i.on("rendered",(function(e){s=e}))}))}))},close:function(){i&&(i.destroy(),i=void 0,s={}),clearTimeout(a),clearTimeout(l),OCA.Books.UI.closeReader(),OCA.Books.UI.refreshProgress(0)},nextPage:function(){i&&i.next()},prevPage:function(){i&&i.prev()},nextSection:function(){i&&s&&i.display((s.next()||{}).href)},prevSection:function(){i&&s&&i.display((s.prev()||{}).href)},toSection:function(e){i&&i.display(e)},toPercent:function(e){if(i){let t=i.book.locations.cfiFromPercentage(e);i.display(t)}},getBook:function(e){return r.filter(t=>t.id==e)[0]},getIds:function(e,t){let n=[];return"author"==e?n=r.filter(e=>void 0!==e.authors&&e.authors.some(e=>e.fileAs==t)):"series"==e?n=r.filter(e=>void 0!==e.series&&e.series.some(e=>e.fileAs==t)):"genre"==e?n=r.filter(e=>void 0!==e.genres&&e.genres.includes(t)):"status"==e?n=r.filter(e=>e.status==t):"shelf"==e&&(n=r.filter(e=>void 0!==e.shelves&&e.shelves.includes(t))),n.map(e=>e.id)},getMeta:function(e){let n=[];return"author"==e?n=r.filter(e=>void 0!==e.authors).map(e=>e.authors.map(e=>[e.fileAs,e.fileAs])).flat():"series"==e?n=r.filter(e=>void 0!==e.series).map(e=>e.series.map(e=>[e.fileAs,e.fileAs])).flat():"genre"==e?n=r.filter(e=>void 0!==e.genres).map(e=>e.genres.map(e=>[e,e])).flat():"status"==e?n=r.map(e=>[[e.status],t("books","status-"+e.status)]):"shelf"==e&&(n=r.filter(e=>void 0!==e.shelves).map(e=>e.shelves.map(e=>[e,e])).flat()),n},getOPF:function(e,t){let n=o.remote+this.getBook(e).filename,r=ePub(n,{replacements:"blobUrl",openAs:"epub"});r.ready.then((function(){let e=Object.keys(r.archive.zip.files).filter(e=>e.endsWith(".opf"))[0];r.archive.getText("/"+e).then(t)}))}}),document.addEventListener("DOMContentLoaded",(function(){OCA.Books.Core.init()}))},49:function(e,t,n){"use strict";n.r(t);var o,r,s=n(2);OCA.Books.Backend=(o=function(e,t){let n=new XMLHttpRequest;n.addEventListener("load",t),n.open("GET",e),n.setRequestHeader("requesttoken",oc_requesttoken),n.send()},r=function(e,t,n){let o=new XMLHttpRequest;o.addEventListener("load",n),o.open("POST",e),o.setRequestHeader("requesttoken",oc_requesttoken),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(t)},{getConfig:function(e){o(Object(s.generateUrl)("apps/books/api/0.1/config"),(function(){e(JSON.parse(this.response))}))},getBooks:function(e){o(Object(s.generateUrl)("apps/books/api/0.1/books"),(function(){e(JSON.parse(this.response))}))},saveProgress:function(e,t,n){let o=`id=${e}&progress=${t}`;r(Object(s.generateUrl)("apps/books/api/0.1/progress"),o,(function(){n(JSON.parse(this.response))}))},saveStatus:function(e,t,n){let o=`id=${e}&status=${t}`;r(Object(s.generateUrl)("apps/books/api/0.1/status"),o,(function(){n(JSON.parse(this.response))}))},scan:function(e,t){let n=new OC.EventSource(Object(s.generateUrl)("apps/books/api/0.1/scan?dir="+e));n.listen("progress",t.updateFunc),n.listen("done",t.doneFunc),n.listen("error",t.errorFunc)},reset:function(e){r(Object(s.generateUrl)("apps/books/api/0.1/reset"),"",(function(){e(JSON.parse(this.response))}))},coverPath:function(e,t){return t?`${Object(s.generateUrl)("apps/books/api/0.1/coverlarge")}/${e}`:`${Object(s.generateUrl)("apps/books/api/0.1/cover")}/${e}`},coverUrl:function(e,t){return`url("${this.coverPath(e,t)}")`}})},79:function(e,t,n){"use strict";n.r(t);n(80),n(82),n(84),n(85),n(22),n(86),n(87),n(88),n(89);OCA.Books.Editor=function(){var e=n(3),t=void 0;window.addEventListener("themechange",(function(e){s.theme=e.detail,t&&t.setOption("theme",e.detail)}));var o=function(t,n){return n&&!n()||setTimeout((function(){t.state.completionActive||t.showHint()}),100),e.Pass},r=function(t){return o(t,(function(){let n=t.getTokenAt(t.getCursor());return!!("string"!=n.type||/['"]/.test(n.string.charAt(n.string.length-1))&&1!=n.string.length)&&e.innerMode(t.getMode(),n.state).state.tagName}))},s={mode:"xml",lineNumbers:!0,styleActiveLine:!0,matchTags:!0,autoCloseTags:!0,tabSize:2,extraKeys:{"'<'":o,"' '":r,"'='":r,"Ctrl-Space":"autocomplete"},hintOptions:{completeSingle:!1,schemaInfo:{"!top":["package"],package:{attrs:{"unique-identifier":null,version:["2.0","3.0"],dir:["ltr","rtl"],id:null,prefix:null,"xml:lang":null},children:["metadata","manifest","spine","guide","collection"]},metadata:{children:["dc:identifier","dc:title","dc:language","dc:contributor","dc:coverage","dc:creator","dc:date","dc:description","dc:format","dc:publisher","dc:relation","dc:rights","dc:source","dc:subject","dc:type","meta","link"]},manifest:{attrs:{id:null},children:["item"]},spine:{attrs:{id:null,"page-progression-direction":["default","ltr","rtl"],toc:["ncx"]},children:["itemref"]},guide:{children:["reference"]},collection:{attrs:{role:null,dir:["ltr","rtl"],id:null,"xml:lang":null},children:["metadata","collection","link"]}}},theme:"default"};return{init:function(n){void 0===t&&(t=e.fromTextArea(document.querySelector(n),s)).refresh()},close:function(){t&&(t.toTextArea(),t=void 0)},setValue:function(e){t&&t.setValue(e)}}}()},90:function(e,n,o){"use strict";o.r(n);var r,s,i,l,a,c,d,u,f,p,m,h,g,y,v,C,k,S,b,A,q,O,E,L,B=o(13);o(92);OCA.Books.UI=(l="author",a="title",c=!0,d=void 0,u=function(e,t){let n=t.querySelector(".more");e.length>1?(n.style.display="inline-block",n.textContent="+"+(e.length-1)):n.style.display="none"},f=function(e){let t=OCA.Books.Core.getMeta(e),n=document.createDocumentFragment(),o=document.createElement("li");o.innerHTML=document.querySelector("#template-list-item").innerHTML,t.forEach(e=>v(o,n,e[0],e[1])),h(n);let r=document.querySelector(`#category div[data-group="${e}"] > ul`);n.prepend(r.firstElementChild),r.innerHTML="",r.appendChild(n)},p=function(e,t){a=e,t&&document.querySelector(`#app-content th.${a} > span:not(.hidden)`)&&(c=!c);let n=document.querySelectorAll("#app-content th.sort");for(let e,t=0;e=n[t];t++)e.classList.contains(a)?e.firstElementChild.classList.remove("hidden"):e.firstElementChild.classList.add("hidden"),c?(e.firstElementChild.classList.remove("icon-triangle-s"),e.firstElementChild.classList.add("icon-triangle-n")):(e.firstElementChild.classList.remove("icon-triangle-n"),e.firstElementChild.classList.add("icon-triangle-s"));let o=document.documentElement.dataset.locale||"en",r=document.querySelector("#app-content tbody"),s=Array.from(r.querySelectorAll("tr"));s.sort((function(e,t){return m(e,t,o)})),s.forEach(e=>{r.appendChild(e)})},m=function(e,t,n){let o=e.querySelector("."+a).dataset.fileAs,r=t.querySelector("."+a).dataset.fileAs,s=o.localeCompare(r,n,{numeric:!0});return c||(s*=-1),s},h=function(e){let t=document.documentElement.dataset.locale||"en",n=Array.from(e.children);n.sort((e,n)=>e.dataset.id.localeCompare(n.dataset.id,t,{numeric:!0})),n.forEach(t=>e.appendChild(t))},g=function(e){document.querySelector(`#list-category > li[data-group="${l}"]`).classList.remove("active"),document.querySelector(`#category > div[data-group="${l}"]`).style.display="none",document.querySelector(`#list-category > li[data-group="${e}"]`).classList.add("active"),document.querySelector(`#category > div[data-group="${e}"]`).style.display="block",l=e,y("all")},y=function(e){let t=document.querySelectorAll("#app-content tbody tr");if("all"==e)t.forEach(e=>e.style.display="table-row");else{let n=OCA.Books.Core.getIds(l,e);for(let e,o=0;e=t[o];o++)e.style.display=n.includes(parseInt(e.dataset.id))?"table-row":"none"}let n=document.querySelectorAll(`#category > div[data-group="${l}"] li`);for(let t,o=0;t=n[o];o++)t.dataset.id==e?t.classList.add("active"):t.classList.remove("active")},v=function(e,t,n,o){let r=t.querySelector(`li[data-id="${n}"]`);if(r){let e=parseInt(r.lastElementChild.textContent);r.lastElementChild.textContent=e+1}else r=e.cloneNode(!0),r.dataset.id=n,r.firstElementChild.textContent=o,r.firstElementChild.addEventListener("click",(function(e){e.preventDefault(),y(e.target.parentNode.dataset.id)})),t.appendChild(r)},C=function(e){let t=document.createDocumentFragment(),n=document.createElement("li");n.innerHTML=document.querySelector("#template-toc-item").innerHTML,e.forEach((function(e){let o=n.cloneNode(!0);o.lastElementChild.textContent=e.label,o.lastElementChild.href=e.href,o.addEventListener("click",q),e.subitems.length>0&&o.appendChild(C(e.subitems)),t.appendChild(o)}));let o=document.createElement("ul");return o.appendChild(t),o},k=function(){let e=document.querySelector("#app-sidebar");e.classList.add("hidden"),e.classList.remove("wide"),e.querySelector("#app-sidebar-raw").dataset.id=void 0,e.querySelector("#app-sidebar-details figure > img").src="",OCA.Books.Editor.close()},S=function(e){let t=document.querySelectorAll("#app-sidebar header nav > a");for(let n,o=0;n=t[o];o++)o==e?n.classList.add("active"):n.classList.remove("active");let n=document.querySelectorAll("#app-sidebar .tabcontent > div");for(let t,o=0;t=n[o];o++)o==e?t.classList.remove("hidden"):t.classList.add("hidden");let o=document.querySelector("#app-sidebar"),r=o.querySelector("#app-sidebar-raw");2==e&&r.dataset.id!=o.dataset.id&&OCA.Books.Core.getOPF(o.dataset.id,(function(e){r.dataset.id=o.dataset.id,OCA.Books.Editor.setValue(e)}))},b=function(e){let t=e.target.closest("tr").dataset.id;OCA.Books.Core.open(t,"reader"),k()},A=function(e){e.preventDefault(),e.stopPropagation(),function(e){let t=document.querySelector("#app-sidebar");if(t.dataset.id=e,t.classList.contains("hidden"))S(0);else{let e=t.querySelector(".tabbar"),n=t.querySelector(".tabbar > .active");S(Array.from(e.children).indexOf(n))}let n=OCA.Books.Core.getBook(e),o=t.querySelector("#app-sidebar-details");o.querySelector(".description").innerHTML=n.description,o.querySelector(".title").textContent=n.titles?n.titles[0].name:"",o.querySelector(".author").textContent=n.authors?n.authors[0].name:"",o.querySelector(".status").value=n.status,o.querySelector(".location").value=n.filename,o.querySelector(".shelves").setSelection(n.shelves||[]);let r=o.querySelector("figure > img");r.src=OCA.Books.Backend.coverPath(e,!0),r.style.display=n.hasCover?"block":"none",OCA.Books.Editor.init("#app-sidebar-raw textarea"),t.classList.remove("hidden")}(e.target.closest("tr").dataset.id)},q=function(e){e.preventDefault(),OCA.Books.Core.toSection(e.target.getAttribute("href"))},O=function(e){clearTimeout(d);let t=document.querySelector("#reader-progress-bar").getBoundingClientRect().width,n=Math.min(Math.max(e.pageX-44,0),t);document.querySelector("#reader-progress-handle").style.left=n-7+"px",document.querySelector("#reader-progress-overlay").style.width=n+"px",d=setTimeout((function(){OCA.Books.Core.toPercent(n/t)}),250)},E=function(){let e=document.querySelector("#reader-progress-handle");e.removeEventListener("mousemove",O),e.removeEventListener("mouseup",E),e.removeEventListener("mouseleave",E),document.querySelector("#reader-progress-bar").classList.remove("active")},L=function(e){"ArrowLeft"==e.code||37==e.keyCode?OCA.Books.Core.prevPage():"ArrowRight"==e.code||39==e.keyCode?OCA.Books.Core.nextPage():"ArrowUp"==e.code||38==e.keyCode?OCA.Books.Core.prevSection():"ArrowDown"==e.code||40==e.keyCode?OCA.Books.Core.nextSection():"Escape"!=e.code&&27!=e.keyCode||OCA.Books.Core.close()},{init:function(){this.Style.init(),this.Multiselect.init(),document.querySelector("#settings-item-scan").addEventListener("click",(function(){var e;OCA.Books.UI.showLoadingScreen(),OCA.Books.Backend.scan(document.querySelector("#path-settings").value,(e=document.querySelector("#spinner > svg circle"),{updateFunc:function(t){let n=t.done/t.total*700;e.style.strokeDasharray=n+" 710"},doneFunc:function(t){OCA.Books.UI.toast(t.message,!0),e.style.strokeDasharray="705 710",setTimeout(OCA.Books.UI.hideLoadingScreen,1e3)},errorFunc:function(e){OCA.Books.UI.toast(e.message,!1),setTimeout(OCA.Books.UI.hideLoadingScreen,1e3)}}))})),document.querySelector("#settings-item-reset").addEventListener("click",(function(){OC.dialogs.confirm(t("books","msg-reset"),t("books","head-reset"),(function(e){e&&OCA.Books.Backend.reset((function(e){OCA.Books.UI.toast(e.message,e.success)}))}),!0)})),document.querySelector("#reader-prev").addEventListener("click",(function(){OCA.Books.Core.prevPage()})),document.querySelector("#reader-next").addEventListener("click",(function(){OCA.Books.Core.nextPage()})),document.querySelector("#reader-close").addEventListener("click",(function(){OCA.Books.Core.close()})),document.querySelector("#reader-progress-handle").addEventListener("mousedown",(function(){OCA.Books.UI.activateSlider()})),document.querySelector("#font-settings").addEventListener("change",(function(e){OCA.Books.UI.Style.setFontSize(e.target.value)})),document.querySelector("#color-settings").addEventListener("change",(function(e){OCA.Books.UI.Style.setTheme(e.target.value)})),document.querySelector("#app-sidebar > header > a").addEventListener("click",(function(e){e.preventDefault(),k()})),document.querySelector("#app-sidebar-raw .icon-fullscreen").addEventListener("click",(function(e){e.preventDefault(),document.querySelector("#app-sidebar").classList.toggle("wide")})),document.querySelector("#app-sidebar-details .status").addEventListener("change",(function(e){let t=parseInt(document.querySelector("#app-sidebar").dataset.id),n=parseInt(e.target.value),o=OCA.Books.Core.getBook(t).status;OCA.Books.Backend.saveStatus(t,n,(function(e){e.success&&(OCA.Books.Core.getBook(t).status=n,OCA.Books.UI.refreshStatus(t,n,o))}))}));let e=document.querySelector("#app-sidebar-details .shelves");e.setOptions(OCA.Books.Core.getMeta("shelf").map(e=>({value:e[0],text:e[1]}))),e.addEventListener("changed",(function(e){let t=parseInt(document.querySelector("#app-sidebar").dataset.id);OCA.Books.Core.getBook(t).shelves=e.detail,f("shelf")}));let n=document.querySelectorAll("#list-category > li > a");for(let e,t=0;e=n[t];t++)e.addEventListener("click",(function(e){g(e.target.parentNode.dataset.group),e.preventDefault()}));let o=document.querySelectorAll("#app-sidebar header nav > a");for(let e,t=0;e=o[t];t++)e.addEventListener("click",(function(t){t.preventDefault(),S(Array.from(e.parentNode.children).indexOf(t.target))}));let r=document.querySelectorAll("th.sort");for(let e,t=0;e=r[t];t++)e.addEventListener("click",(function(e){OCA.Books.UI.sortShelf(e.target.dataset.sort)}))},buildNavigation:function(e){let t=document.querySelectorAll("#category li:first-child");for(let n,o=0;n=t[o];o++)n.lastElementChild.textContent=e.length,n.firstElementChild.onclick=function(e){y(e.target.parentNode.dataset.id)};f("author"),f("series"),f("genre"),f("status"),f("shelf"),g(l)},buildShelf:function(e){let n=document.createDocumentFragment(),o=document.createElement("tr");o.innerHTML=document.querySelector("#template-shelf-item").innerHTML;for(let r,s=0;r=e[s];s++){let e=o.cloneNode(!0),s=e.querySelectorAll(".field");if(e.dataset.id=r.id,e.className="app-shelf-item",0!=r.status&&(s[0].querySelector(".status-"+r.status).style.display="block"),r.hasCover?s[0].firstElementChild.style.backgroundImage=OCA.Books.Backend.coverUrl(r.id):s[0].querySelector(".placeholder").textContent=r.titles[0].fileAs.substring(0,2),s[1].querySelector(".title-1").textContent=r.titles[0].name,s[1].dataset.fileAs=r.titles[0].fileAs,s[1].addEventListener("click",b),s[1].querySelector("a.action").addEventListener("click",A),r.series){let e=r.series[0];s[1].dataset.fileAs=`${e.fileAs}${e.pos}`,s[1].querySelector(".title-2").textContent=`${e.name} ${e.pos}`}r.authors&&(s[0].firstElementChild.style.backgroundColor=r.authors[0].color,s[2].dataset.fileAs=r.authors[0].fileAs,s[2].querySelector(".author-1").textContent=r.authors[0].name,u(r.authors,s[2])),r.genres&&(s[3].dataset.fileAs=r.genres[0],s[3].querySelector(".genre-1").textContent=r.genres[0],u(r.genres,s[3]));let i=t("books",r.languages[0]);s[4].dataset.fileAs=i,s[4].querySelector(".lang-1").textContent=i,u(r.languages,s[4]),n.appendChild(e)}let r=document.querySelector("#app-shelf-body");r.textContent="",r.appendChild(n),p(a)},sortShelf:function(e){p(e,!0)},buildTOC:function(e){let t=document.querySelector("#app-navigation-toc");t.textContent="",t.appendChild(C(e))},buildMarkers:function(e){let t=document.createDocumentFragment();e.forEach((function(e){let n=document.createElement("div");n.className="marker",n.style.left=100*e+"%",t.appendChild(n)}));let n=document.querySelector("#reader-progress-markers");n.textContent="",n.appendChild(t)},openReader:function(){document.querySelector("#app").classList.add("reader"),window.addEventListener("keyup",L)},closeReader:function(){document.querySelector("#app").classList.remove("reader"),window.removeEventListener("keyup",L),this.hideLoadingScreen()},showLoadingScreen:function(){document.querySelector("#spinner").style.display="block"},hideLoadingScreen:function(){document.querySelector("#spinner").style.display="none",document.querySelector("#spinner svg circle").style.strokeDasharray="0 710"},activateSlider:function(){let e=document.querySelector("#reader-progress-handle");e.addEventListener("mousemove",O),e.addEventListener("mouseup",E),e.addEventListener("mouseleave",E),document.querySelector("#reader-progress-bar").classList.add("active")},refreshProgress:function(e,t){if(!document.querySelector("#reader-progress-bar").classList.contains("active")){e*=100;let t=document.querySelector("#reader-progress-handle"),n=document.querySelector("#reader-progress-overlay");t.style.left=`calc(${e}% - 6px)`,n.style.width=e+"%"}let n=document.querySelectorAll("#app-navigation-toc li");for(let e,o=0;e=n[o];o++)e.firstElementChild.getAttribute("href")==t?e.classList.add("active"):e.classList.remove("active")},refreshStatus:function(e,t,n){let o=document.querySelectorAll(`#app-content tr[data-id="${e}"] .cover .icon`);for(let e,n=0;e=o[n];n++)e.style.display=e.classList.contains("status-"+t)?"block":"none";void 0!==n&&t!=n&&f("status")},toast:function(e,t){void 0===t?Object(B.b)(e):t?Object(B.c)(e):Object(B.a)(e)},Style:(r={html:{"font-size":"initial"},body:{"font-size":"inherit","text-align":"justify"},p:{"max-width":"32em"}},s=function(e){r.html["font-size"]=e,window.dispatchEvent(new Event("bookstylechange"))},i=function(e){window.dispatchEvent(new CustomEvent("themechange",{detail:e}))},{setFontSize:function(e){window.localStorage.setItem("font-size",e),s(e)},setTheme:function(e){window.localStorage.setItem("theme",e),i(e)},get:function(){return r},init:function(){let e=window.localStorage.getItem("font-size")||"initial",t=window.localStorage.getItem("theme")||"default";document.querySelector("#font-settings").value=e,document.querySelector("#color-settings").value=t,s(e),i(t)}}),Multiselect:function(){var e=`<ul><li tabindex='0'></li></ul><input type='text' placeholder='${t("books","hint-ms")}'><div class='selected'></div>`,n=function(e){let t=Array.from(e.querySelectorAll(".selected")).map(e=>e.dataset.value);return new CustomEvent("changed",{detail:t})};let o=function(e,t,o){let r=document.createElement("li");return r.dataset.value=e,r.textContent=t,r.tabIndex=0,r.className=o?"selected":"",r.addEventListener("click",(function(e){e.target.classList.toggle("selected");let t=e.target.closest("multiselect");t.dispatchEvent(n(t.querySelector("ul"))),t.querySelector("div.selected").refresh();let o=t.querySelector("input");o.focus(),o.reset()})),r};var r=function(t){t.innerHTML=e;let r=t.querySelector("ul"),s=t.querySelector("div.selected"),i=t.querySelector("input");t.setOptions=function(e){let t=document.documentElement.dataset.locale||"en";(e=e.filter((e,t,n)=>n.findIndex(t=>t.value===e.value)===t)).sort((e,n)=>e.text.localeCompare(n.text,t,{numeric:!0}));let n=document.createDocumentFragment();e.forEach(e=>n.appendChild(o(e.value,e.text))),n.appendChild(r.lastElementChild),r.innerHTML="",r.appendChild(n),r.refresh(),s.refresh()},t.addOption=function(e,t,n){let i=r.lastElementChild;r.appendChild(o(e,t,n));let l=document.documentElement.dataset.locale||"en",a=Array.from(r.children);a.sort((e,t)=>e.textContent.localeCompare(t.textContent,l,{numeric:!0})),a.forEach(e=>r.appendChild(e)),r.appendChild(i),r.refresh(),s.refresh()},t.setSelection=function(e){r.children.forEach(t=>{e.includes(t.dataset.value)?t.classList.add("selected"):t.classList.remove("selected")}),s.refresh()},t.addEventListener("focusout",(function(e){t.contains(e.relatedTarget)?e.preventDefault():(s.style.display="block",i.style.display="none",r.style.display="none",i.reset())})),r.reset=function(){r.lastElementChild.textContent="",r.refresh()},r.refresh=function(){let e=r.lastElementChild.textContent.toLowerCase(),t=r.querySelectorAll("li:not(:last-child");t.forEach(t=>{t.style.display=t.textContent.toLowerCase().includes(e)?"list-item":"none"});let n=!1;r.children.length<2?n=!0:""!=e&&(n=0==Array.from(t).filter(t=>t.textContent.toLowerCase()==e).length),r.lastElementChild.style.display=n?"list-item":"none",r.style.top=`-${r.clientHeight+2}px`},r.lastElementChild.addEventListener("click",(function(){let e=r.lastElementChild.textContent;i.focus(),t.addOption(e,e,!0),t.dispatchEvent(n(r)),i.reset()})),s.refresh=function(){let e=Array.from(r.querySelectorAll(".selected"));s.innerHTML=e.map(e=>`<span>${e.textContent}</span>`).join("")},s.addEventListener("click",(function(){s.style.display="none",r.style.display="block",r.style.top=`-${r.clientHeight+2}px`,i.style.display="block",i.focus()})),i.reset=function(){i.value="",r.reset()},i.addEventListener("input",(function(){r.lastElementChild.textContent=i.value,r.refresh()}))};return{init:function(){let e=document.querySelectorAll("#app-sidebar multiselect");for(let t,n=0;t=e[n];n++)0==t.children.length&&r(t)}}}()})}});